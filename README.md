# –ó–∞–¥–∞–Ω–∏–µ 5: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ (openssl)

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–æ–∑–¥–∞—Ç—å GitHub Actions workflow, –∫–æ—Ç–æ—Ä—ã–π:
- –°–∫–∞–Ω–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –∫–æ–ø–∏—é –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ openssl, –Ω–∞—Ö–æ–¥—è—â—É—é—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–∫–∞–Ω–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Trivy —Å –∫–æ–º–∞–Ω–¥–æ–π `trivy fs --scanners secret`
- –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤ ‚Äî –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø–∞–π–ø–ª–∞–π–Ω —Å –æ—à–∏–±–∫–æ–π

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–æ–ª–∂–Ω—ã –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ openssl
2. ‚úÖ **–ü—Ä–æ–µ–∫—Ç —Ñ–æ—Ä–∫–Ω—É—Ç:** https://github.com/TrooSlash/openssl
3. ‚úÖ **–ò—Å—Ö–æ–¥–Ω–∏–∫–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ** –≤ –ø–∞–ø–∫—É `task5/openssl/`
4. –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤ ‚Äî workflow –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å exit code 1

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç workflow

### –®–∞–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

1. **Checkout code** - —Å–∫–∞—á–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–≤–∫–ª—é—á–∞—è –≤—Å–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ openssl –∏–∑ `task5/openssl/`)
2. **Install Trivy** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–∫–∞–Ω–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Trivy —á–µ—Ä–µ–∑ APT
3. **Scan for secrets** - —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ openssl –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤

### –ö–æ–º–∞–Ω–¥–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:

```bash
trivy fs --scanners secret --exit-code 1 task5/openssl/
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `fs` - —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã (–∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞)
- `--scanners secret` - –≤–∫–ª—é—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –¥–µ—Ç–µ–∫—Ç–æ—Ä —Å–µ–∫—Ä–µ—Ç–æ–≤
- `--exit-code 1` - –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å –∫–æ–¥–æ–º –æ—à–∏–±–∫–∏ 1 –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤
- `task5/openssl/` - –ø—É—Ç—å –∫ –ª–æ–∫–∞–ª—å–Ω–æ–π –∫–æ–ø–∏–∏ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ openssl

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫:
```bash
git push origin main
```

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É **Actions** –Ω–∞ GitHub
2. –í—ã–±–µ—Ä–∏—Ç–µ workflow **Task 5 - Scan for Secrets**
3. –ù–∞–∂–º–∏—Ç–µ **Run workflow** ‚Üí **Run workflow**

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –ï—Å–ª–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤ –ù–ï –Ω–∞–π–¥–µ–Ω–æ:
- Workflow –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ (–∑–µ–ª—ë–Ω–∞—è –≥–∞–ª–æ—á–∫–∞)
- Exit code: 0

### ‚ùå –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Å–µ–∫—Ä–µ—Ç—ã:
- Workflow –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π (–∫—Ä–∞—Å–Ω—ã–π –∫—Ä–µ—Å—Ç–∏–∫)
- Exit code: 1
- –í –ª–æ–≥–∞—Ö –±—É–¥–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ (API keys, tokens, passwords –∏ —Ç.–¥.)

**–≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ!** Workflow –¥–æ–ª–∂–µ–Ω –ø–∞–¥–∞—Ç—å –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤.

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

### –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è OpenSSL:

–ü—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ openssl –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ **28 —Ñ–∞–π–ª–æ–≤ —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏**:

üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- **–í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ —Å–µ–∫—Ä–µ—Ç–æ–≤:** 31 (28 —Ñ–∞–π–ª–æ–≤ + 3 –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ)
- **–£—Ä–æ–≤–µ–Ω—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏:** HIGH (–≤—ã—Å–æ–∫–∏–π)
- **–¢–∏–ø —Å–µ–∫—Ä–µ—Ç–æ–≤:** AsymmetricPrivateKey (–ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏)

üìÅ **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤:**

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –§–∞–π–ª–æ–≤ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|--------|----------|
| `apps/*.pem` | 11 | –¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π |
| `demos/bio/*.pem` | 2 | –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è BIO API |
| `demos/certs/apps/*.pem` | 5 | –î–µ–º–æ-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã |
| `demos/cms/*.pem` | 3 | –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è CMS |
| `demos/guide/*.pem` | 2 | –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–ª—é—á–∏ |
| `demos/smime/*.pem` | 3 | –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è S/MIME |
| `demos/sslecho/key.pem` | 1 | –ö–ª—é—á –¥–ª—è SSL Echo |
| `fuzz/dtlsserver.c` | 1 —Ñ–∞–π–ª (3 –∫–ª—é—á–∞) | –ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ |

### –ü—Ä–∏–º–µ—Ä—ã –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤:

```
HIGH: AsymmetricPrivateKey (private-key)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Asymmetric Private Key
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 apps/ca-key.pem:2-15 (offset: 28 bytes)
 apps/server.pem:21-46 (offset: 1179 bytes)
 demos/guide/rootkey.pem:2-27 (offset: 28 bytes)
 fuzz/dtlsserver.c:141-166 (offset: 10130 bytes)
```

### –ü–æ—á–µ–º—É —ç—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ –¥–ª—è OpenSSL:

‚úÖ **OpenSSL - –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞**, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è:
- –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è unit-—Ç–µ—Å—Ç–æ–≤
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–ª—é—á–∏ –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è —Ç—É—Ç–æ—Ä–∏–∞–ª–æ–≤

‚úÖ **–í—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏:**
- –Ø–≤–ª—è—é—Ç—Å—è —á–∞—Å—Ç—å—é –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã openssl
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- –ù–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Ä–µ–∞–ª—å–Ω–æ–π —É–≥—Ä–æ–∑—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã

‚úÖ **Workflow —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–∏–ª –∑–∞–¥–∞—á—É:**
- –û–±–Ω–∞—Ä—É–∂–∏–ª –≤—Å–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å exit code 1
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ –Ω–∞—Ö–æ–¥–∫–∞—Ö

## –ß—Ç–æ –∏—â–µ—Ç Trivy (—Ç–∏–ø—ã —Å–µ–∫—Ä–µ—Ç–æ–≤)

Trivy –º–æ–∂–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å:
- AWS Access Keys
- GitHub Tokens
- Private SSH Keys
- Database passwords
- API Keys
- OAuth tokens
- JWT tokens
- –ò –º–Ω–æ–≥–∏–µ –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã credentials

## –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ–± OpenSSL

OpenSSL ‚Äî —ç—Ç–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –ø–æ—ç—Ç–æ–º—É –≤ –µ—ë —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è:
- –¢–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ (RSA, DSA, EC)
- –ü—Ä–∏–º–µ—Ä—ã —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ credentials –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ

–≠—Ç–æ **–Ω–æ—Ä–º–∞–ª—å–Ω–æ** –¥–ª—è —Ç–∞–∫–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–∏ —Ñ–∞–π–ª—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

### –¢–∏–ø—ã –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π:

üîë **RSA Private Keys** - –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ç–∏–ø
- –†–∞–∑–º–µ—Ä—ã: 512, 1024, 2048, 8192 –±–∏—Ç
- –§–æ—Ä–º–∞—Ç: PEM (BEGIN RSA PRIVATE KEY)
- –ü—Ä–∏–º–µ—Ä—ã: `apps/server.pem`, `apps/client.pem`, `demos/bio/server.pem`

üîë **DSA Private Keys** - —Ü–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å
- –§–æ—Ä–º–∞—Ç: PEM (BEGIN DSA PRIVATE KEY)  
- –ü—Ä–∏–º–µ—Ä—ã: `apps/dsa-ca.pem`, `apps/dsa-pca.pem`

üîë **EC Private Keys** - —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏–≤—ã–µ
- –§–æ—Ä–º–∞—Ç: PEM (BEGIN EC PRIVATE KEY)
- –ü—Ä–∏–º–µ—Ä—ã: `demos/bio/server-ec.pem`

üîë **Generic Private Keys** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç PKCS#8
- –§–æ—Ä–º–∞—Ç: PEM (BEGIN PRIVATE KEY)
- –ü—Ä–∏–º–µ—Ä—ã: `apps/ca-key.pem`, `demos/guide/rootkey.pem`

### –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —ç—Ç–∏ –∫–ª—é—á–∏:

| –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|------------|
| `apps/` | –£—Ç–∏–ª–∏—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ OpenSSL (—Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ) |
| `demos/` | –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ |
| `test/` | Unit-—Ç–µ—Å—Ç—ã –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã |
| `fuzz/` | –§–∞–∑–∑–∏–Ω–≥-—Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π |

## –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Trivy

**Windows (PowerShell):**
```powershell
# –ß–µ—Ä–µ–∑ Chocolatey
choco install trivy

# –ß–µ—Ä–µ–∑ Scoop
scoop install trivy

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
trivy --version
```

**Linux (Ubuntu/Debian):**
```bash
sudo apt-get update
sudo apt-get install -y wget apt-transport-https gnupg lsb-release
curl -fsSL https://aquasecurity.github.io/trivy-repo/deb/public.key | sudo gpg --dearmor -o /usr/share/keyrings/trivy.gpg
echo "deb [signed-by=/usr/share/keyrings/trivy.gpg] https://aquasecurity.github.io/trivy-repo/deb $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/trivy.list
sudo apt-get update
sudo apt-get install -y trivy
```

### –ó–∞–ø—É—Å–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ

**–ë–∞–∑–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
cd D:\Yandex.Disk\project\p34

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏ –Ω–∞—Ö–æ–¥–∫–∞—Ö)
trivy fs --scanners secret task5/openssl/

# –° –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤ (–∫–∞–∫ –≤ CI)
trivy fs --scanners secret --exit-code 1 task5/openssl/
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏:**
```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ñ–∞–π–ª
trivy fs --scanners secret -o results.txt task5/openssl/

# –§–æ—Ä–º–∞—Ç JSON –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
trivy fs --scanners secret -f json -o results.json task5/openssl/

# –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ HIGH –∏ CRITICAL –Ω–∞—Ö–æ–¥–∫–∏
trivy fs --scanners secret --severity HIGH,CRITICAL task5/openssl/

# –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
trivy fs --scanners secret -d task5/openssl/
```

### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–£—Ä–æ–≤–Ω–∏ —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏:**
- üî¥ **CRITICAL** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (—Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è)
- üü† **HIGH** - –≤—ã—Å–æ–∫–∏–µ (—Ç—Ä–µ–±—É—é—Ç –±—ã—Å—Ç—Ä–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
- üü° **MEDIUM** - —Å—Ä–µ–¥–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å)
- üü¢ **LOW** - –Ω–∏–∑–∫–∏–µ (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å)
- ‚ö™ **UNKNOWN** - –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ (—Ç—Ä–µ–±—É—é—Ç –∞–Ω–∞–ª–∏–∑–∞)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
p34/
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ task5.yml          # GitHub Actions workflow
‚îú‚îÄ‚îÄ task5/
‚îÇ   ‚îî‚îÄ‚îÄ openssl/               # –õ–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–ø–∏—è –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ openssl (~8000+ —Ñ–∞–π–ª–æ–≤)
‚îÇ       ‚îú‚îÄ‚îÄ crypto/
‚îÇ       ‚îú‚îÄ‚îÄ ssl/
‚îÇ       ‚îú‚îÄ‚îÄ test/
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ README.md                  # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ –ë–∏–ª–µ—Ç—ã.md                  # –ó–∞–¥–∞–Ω–∏—è –Ω–∞ —ç–∫–∑–∞–º–µ–Ω
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∑–∞–¥–∞–Ω–∏—é

‚úÖ –ò—Å—Ö–æ–¥–Ω–∏–∫–∏ openssl –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (—Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ —Ñ–æ—Ä–∫–∞)  
‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `trivy fs --scanners secret`  
‚úÖ –§–ª–∞–≥ `--exit-code 1` –∑–∞–≤–µ—Ä—à–∞–µ—Ç workflow –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤  
‚úÖ –°–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è –ø–∞–ø–∫–∞ `task5/openssl/` (–ª–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–ø–∏—è –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ openssl)  
‚úÖ Workflow –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ `workflow_dispatch`

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Trivy:
- [Trivy Secret Scanning Documentation](https://trivy.dev/v0.67/docs/scanner/secret/)
- [Trivy CLI Reference](https://trivy.dev/v0.67/docs/references/cli/)
- [Trivy Configuration](https://trivy.dev/v0.67/docs/references/configuration/)

### –ü—Ä–æ–µ–∫—Ç OpenSSL:
- [–§–æ—Ä–∫ openssl](https://github.com/TrooSlash/openssl)
- [–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π openssl](https://github.com/openssl/openssl)
- [OpenSSL Documentation](https://www.openssl.org/docs/)

### GitHub Actions:
- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [Workflow Syntax](https://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions)
- [GitHub Secrets](https://docs.github.com/en/actions/security-for-github-actions/security-guides/using-secrets-in-github-actions)

### –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –∑–∞–¥–∞–Ω–∏–µ–º:
- [Management-and-administration-of-information-systems--tasks](https://github.com/TrooSlash/Management-and-administration-of-information-systems--tasks)
- [GitHub Actions Runs](https://github.com/TrooSlash/Management-and-administration-of-information-systems--tasks/actions)

## Troubleshooting (—Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º)

### –ü—Ä–æ–±–ª–µ–º–∞: "Trivy not found"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Trivy
trivy --version

# –ï—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—ã—à–µ
choco install trivy  # Windows
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Permission denied" –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# Windows: –ó–∞–ø—É—Å—Ç–∏—Ç–µ PowerShell –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
# Linux: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ sudo –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
chmod -R 755 task5/openssl/
```

### –ü—Ä–æ–±–ª–µ–º–∞: Workflow –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π

**–≠—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ!** –ï—Å–ª–∏ Trivy –Ω–∞—Ö–æ–¥–∏—Ç —Å–µ–∫—Ä–µ—Ç—ã, –æ–Ω –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å exit code 1.

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ workflow –≤ GitHub Actions
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã - —ç—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
3. –î–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ - —É–¥–∞–ª–∏—Ç–µ –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã
4. –î–ª—è —É—á–µ–±–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ (–∫–∞–∫ —ç—Ç–æ—Ç) - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞: –°–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø–∞–ø–∫—É
trivy fs --scanners secret task5/openssl/apps/

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
trivy fs --scanners secret --parallel 8 task5/openssl/
```

## FAQ (–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã)

**Q: –ü–æ—á–µ–º—É workflow –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π?**  
A: –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ! –§–ª–∞–≥ `--exit-code 1` –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç Trivy –∑–∞–≤–µ—Ä—à–∞—Ç—å—Å—è —Å –æ—à–∏–±–∫–æ–π –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤. –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è CI/CD –ø–∞–π–ø–ª–∞–π–Ω–æ–≤.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã?**  
A: –î–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.trivyignore` —Ñ–∞–π–ª –∏–ª–∏ —Ñ–ª–∞–≥ `--skip-files`:
```bash
trivy fs --scanners secret --skip-files "apps/*.pem" task5/openssl/
```

**Q: –ö–∞–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ HIGH –∏ CRITICAL?**  
A: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–ª–∞–≥ `--severity`:
```bash
trivy fs --scanners secret --severity HIGH,CRITICAL task5/openssl/
```

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤?**  
A: –î–∞! –ó–∞–º–µ–Ω–∏—Ç–µ –ø—É—Ç—å `task5/openssl/` –Ω–∞ –ª—é–±—É—é –¥—Ä—É–≥—É—é –ø–∞–ø–∫—É —Å –∏—Å—Ö–æ–¥–Ω–∏–∫–∞–º–∏.

**Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Ä–µ–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã?**  
A: 
1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–æ–∑–≤–∞—Ç—å/–∏–∑–º–µ–Ω–∏—Ç—å —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ credentials
2. –£–¥–∞–ª–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ git (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ git filter-branch –∏–ª–∏ BFG)
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GitHub Secrets –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
4. –í–Ω–µ–¥—Ä–∏—Ç—å pre-commit —Ö—É–∫–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∫–æ–º–º–∏—Ç–æ–≤ —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏

**Q: –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–Ω–∏–º–∞–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ?**  
A: –î–ª—è OpenSSL (~8000+ —Ñ–∞–π–ª–æ–≤) - –æ–∫–æ–ª–æ 3-5 —Å–µ–∫—É–Ω–¥ –ª–æ–∫–∞–ª—å–Ω–æ –∏ 10-15 —Å–µ–∫—É–Ω–¥ –≤ GitHub Actions.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Trivy –≤ pre-commit?**  
A: –î–∞! –°–æ–∑–¥–∞–π—Ç–µ `.pre-commit-config.yaml`:
```yaml
repos:
  - repo: local
    hooks:
      - id: trivy
        name: Trivy secret scanner
        entry: trivy fs --scanners secret --exit-code 1 .
        language: system
        pass_filenames: false
```
